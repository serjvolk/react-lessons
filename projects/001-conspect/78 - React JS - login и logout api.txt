Кароче ничего нового но много написанно, сделали login и logout. Сравни файлы гитом и надеюсь всё поймешь.